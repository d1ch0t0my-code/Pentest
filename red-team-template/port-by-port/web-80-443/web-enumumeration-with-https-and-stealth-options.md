# Web Enumumeration With HTTPS and Stealth Options

## Set Temporaty Variables

#### **IP**

```
ip=192.168.1.10
```

#### **User Agents**

```
agent1="Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.3"
```

```
agent2="Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36"
```

#### **Diccionarios**

```
common="/usr/share/seclists/Discovery/Web-Content/common.txt" \
big="/usr/share/seclists/Discovery/Web-Content/big.txt" \
cgis="/usr/share/dirb/wordlists/vulns/cgis.txt" \
raft="/usr/share/golismero/wordlist/fuzzdb/Discovery/PredictableRes/raft-large-words.txt" \
status-codes="200,204,301,302,307,403,500"
```

{% hint style="info" %}
**For more stealth, switch between user agents**
{% endhint %}

## HTTPS Reconnaissance

#### HTTP request

```
curl -A $agent1 $ip -s -L > 08.02_curl_-k_-s_-L_RAW.txt
```

#### HTTPS request

```
curl -k -A $agent1 https://$ip -s -L | html2text -width '99' | uniq > curl_-k_-s_-L_html2text_uniq.txt
```

## Checking Headers

#### HTTP request

```
HTTP: curl -A $agent1 -i http://$ip > curl_-A_-i_Mozilla.txt
```

#### HTTPS request

```
HTTPS: curl -k -A $agent1 -i https://$ip > curl_-k_-A_-i_Mozilla.txt
```

## Looking for hidden web applications

### Checking robots.txt

```shell-session
curl -A $agent1 http://$ip  > curl_-A_Mozilla_robots.txt_-s_html2text.txt?
```

### URL brute force

#### With common.txt dictionary

```shell-session
gobuster -r -u http://$ip/ --a $agent2 --threads 1 -w $common -s $status-codes -e -o gobuster_Mozilla_common.txt
```

#### With big.txt dictionary

```shell-session
gobuster -r -u http://$ip/  --a $agent2 --threads 1 -w $big -s $status-codes -e -o gobuster_--useragent_Mozilla_big.txt
```

#### With CGI-bin dictionary

```shell
gobuster -r -u http://$ip/ --a $agent2 --threads 1 -w $cgis -s $status-codes -e -o gobuster_--useragent_Mozilla_cgis.txt
```

#### With raft-large-words.txt  dictionary

```shell
gobuster -r -u http://$ip/  --a $agent2 --threads 1 -w $raft -s $status-codes -e -o gobuster_-r_--useragent_Mozilla_raft.txt
```

## Trying to upload a file

&#x20;If PUT method is allowed

```shell-session
echo "test" > test.txt \
curl -A $agent1 --upload-file test.txt -v --url http://$ip > curl_-A_Mozilla_--upload-file_-v.txt
```

## Nikto

{% hint style="info" %}
**To try to be more stealthy, change the default user agent of Nikto**\
change default user-agent in **/etc/nikto.conf** to the following one:\
\
<mark style="color:green;">USERAGENT=Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36</mark>
{% endhint %}

```shell-session
nikto -host $ip -C all -port 80 -output 08.14_nikto_-C_all_-timeout_15_-port_80.txt
```

## Interesting discovered pages
