# Web Enumumeration Stealth

## Set Temporaty Variables

#### **IP**

```
ip=192.168.1.10
```

#### **User Agents**

```
agent1="Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.3"
```

```
agent2="Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36"
```

#### **Diccionarios**

```
common="/usr/share/seclists/Discovery/Web-Content/common.txt" \
big="/usr/share/seclists/Discovery/Web-Content/big.txt" \
cgis="/usr/share/dirb/wordlists/vulns/cgis.txt" \
raft="/usr/share/golismero/wordlist/fuzzdb/Discovery/PredictableRes/raft-large-words.txt" \
status-codes="200,204,301,302,307,403,500"
```

{% hint style="info" %}
**For more stealth go changing the user agent**
{% endhint %}

## HTTPS Reconnaissance
```shell
curl -k -A $agent1 https://$ip -s -L | html2text -width '99' | uniq > curl_-k_-s_-L_html2text_uniq.txt
curl -A $agent1 $ip -s -L > 08.02_curl_-k_-s_-L_RAW.txt
```


## Checking Headers
    HTTP: curl -A $agent1 -i http://$ip > curl_-A_-i_Mozilla.txt
    HTTPS: curl -k -A $agent1 -i https://$ip > curl_-k_-A_-i_Mozilla.txt


## Looking for hidden web applications

### Checking robots.txt
```shell
curl -A $agent1 http://$ip  > curl_-A_Mozilla_robots.txt_-s_html2text.txt?
```

### URL brute force (common.txt)
```shell
gobuster -r -u http://$ip/ --a $agent2 --threads 1 -w $common -s $status-codes -e -o gobuster_Mozilla_common.txt
```

### URL brute force (big.txt)
```shell
gobuster -r -u http://$ip/  --a $agent2 --threads 1 -w $big -s $status-codes -e -o gobuster_--useragent_Mozilla_big.txt
```

### URL brute force (CGI-bin)
```shell
gobuster -r -u http://$ip/ --a $agent2 --threads 1 -w $cgis -s $status-codes -e -o gobuster_--useragent_Mozilla_cgis.txt
```

### URL brute force (raft-large-words.txt)
```shell
gobuster -r -u http://$ip/  --a $agent2 --threads 1 -w $raft -s $status-codes -e -o gobuster_-r_--useragent_Mozilla_raft.txt
```


## Trying to upload a file if PUT is allowed
```shell
echo "test" > test.txt \
curl -A $agent1 --upload-file test.txt -v --url http://$ip > curl_-A_Mozilla_--upload-file_-v.txt
```


## Nikto
{% hint style="info" %}
**For more stealth change the Nikto default user-agnet**
change default user-agent in /etc/nikto.conf to the following one
`USERAGENT=Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36`
{% endhint %}

```shell
nikto -host $ip -C all -port 80 -output 08.14_nikto_-C_all_-timeout_15_-port_80.txt
```

## Interesting discovered pages