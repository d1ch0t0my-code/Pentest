# Web Enumeration \[ 80 / 443 ]

Set Temporary Variables

```shell-session
ip=<VictimIP>
```

## Reconnaissance

```shell-session
curl $ip -s -L | html2text -width '99' | uniq > curl_html2text_uniq.txt
```

#### Links Extraction

```shell-session
curl $ip -s -L > curl_RAW.txt \
cat 08.02_curl_-s_-L_RAW.txt | grep -oE 'http.*"'
```

#### Checking headers

```shell-session
curl -i $ip > curl_-i.txt
```

## Testing HTTP methods

{% hint style="info" %}
You can use **BurpSuite** as **a proxy on terminal requests** using the <mark style="color:green;">--proxy</mark> argument of the curl command
{% endhint %}

```shell-session
ecurl -X OPTIONS -v http://$ip 2> curl_OPTIONS_-v.txt
```

#### Trying to upload a file if PUT is allowed

```shell-session
echo "test" > test.txt
curl --upload-file test.txt -v --url https://$ip/test.txt > curl_--upload-file.txt
```

## WebDAV enumeration and vulnerabilities

```shell-session
davtest [-auth $user:$pass] [-cleanup] -url http://$ip > davtest_-cleanup.txt
```

```
davtest [-auth $user:$pass] -rand evilhacker -url http://$ip > davtest_-rand.txt
```

```
nmap $ip -p80,8080 --script http-webdav-scan -oN nmap_-p80_8080_--script_http-webdav-scan.nmap
```

```
nmap $ip -n -Pn -p80 --script=http-iis-webdav-vuln -oN nmap_-p80_--script_http-iis-webdav-vuln.nmap
```

```
nmap $ip -n -Pn -p80 --script=http-iis-short-name-brute.nse -oN nmap_-p80_--script_http-iis-short-name-brute.nmap
```

### Cadaver Connection

```
cadaver http://$ip/
```

#### **Cadaver Common commands**

```
dav:/> ? 				← Verify commands that can be executed
dav:/> put archivo.ext 	← Upload file to server
```

## Domain Enumeration

#### Find website blocker

e.g: Change the value of "Host:" flag in a GET request for "test", to find the domain name of who is blocking\
[Initial Request](../../../.gitbook/assets/images/initial\_request.png)                                           [Modified Request](../../../.gitbook/assets/images/modified\_request.png)\
<img src="../../../.gitbook/assets/images/initial_request.png" alt="Initial Request" data-size="original"> <img src="../../../.gitbook/assets/images/modified_request.png" alt="Modified Request" data-size="original">\
[Domain Name](../../../.gitbook/assets/images/domain\_name.png)\
<img src="../../../.gitbook/assets/images/domain_name.png" alt="Domain Name" data-size="original">

Change the value of "Host:" flag in a GET request with the Domain Name of who is blocking us "pi.hole"\
![Change Flag](../../../.gitbook/assets/images/change\_flag.png)

## Interesting discovered pages

## SQL Injections

1. Locate a form field, login or similar that can query the server's SQL database.
2. Test if it is susceptible to a SQLi of any type (Error Based, Blind SQL injection Time Based, etc.)

#### Quick test

insert a single quotation mark (<mark style="color:green;">**'**</mark>) in the field and observe the response, if it is an error it is susceptible

#### **In these li**nks you can find More info about [Quick Tests](../../../pentesting/exploitation/web/sql\_injection.md#quick-test) and [SLQi Resources](../../../pentesting/exploitation/web/sql\_injection.md)

## SQL Injections With SQLMAP

{% hint style="danger" %}
## <mark style="color:red;">NO IN OSCP!!!</mark>
{% endhint %}

### Injection en GET

```
sqlmap -u  "http://$ip/jabcd0cs/ajax_udf.php?q=1&add_value=odm_user" -p "add_value"
```

Where:

* <mark style="color:orange;">--current-user</mark> user of the database
* <mark style="color:orange;">--current-db</mark> database in use
* <mark style="color:orange;">-D jabcd0cs --tables</mark> database tables

### Technique to data pass when is a POST method

{% hint style="info" %}
**Source:** hackertarget post [sqlmap POST request injection](https://hackertarget.com/sqlmap-post-request-injection/)
{% endhint %}

Through burp whe capture the login attempt, copy the generated POST and save it to a file \[post-data.txt], and we passed that file to sqlmap

```
sqlmap -r post-data.txt --current-user
```

Another option is

```
sqlmap -u "full-form-router" --forms --dbs
```

### Dump Data From a Table

```
sqlmap -u "http://$ip/section.php?id=51" --dump -D safecosmetics -T users
```
